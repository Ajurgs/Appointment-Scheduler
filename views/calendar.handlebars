<script
  src="https://cdn.jsdelivr.net/npm/fullcalendar@5.7.0/main.min.js"
></script>
<script>
  const appointmentsTest = [
    {
      title  : 'event1',
      start  : '2021-06-02T14:30:00',
      end    : '2021-06-02T15:30:00',
      allDay: false
    },
    {
      title  : 'event2',
      start  : '2021-06-02T10:30:00',
      end    : '2021-06-02T11:30:00',
      allDay: false
    },
    {
      title  : 'event3',
      start  : '2021-06-01T12:30:00',
      end    : '2021-06-01T13:30:00',
      allDay : false // will make the time show
    }
  ];
  console.log(appointmentsTest);

  const loadDataEvent = new CustomEvent("dataLoaded");
const formattedData = [];
  async function getAppointments(){ 
     const temp = await fetch("/api/appointment/");
     await temp.json().then(data =>{
    console.log(data);
    data.map(event =>{
      formattedData.push({id:event.id,title:"test Title",start:event.start,end:event.end})
      document.dispatchEvent(loadDataEvent);
    })
  });
  }
  getAppointments();
  console.log(formattedData);
  document.addEventListener('dataLoaded', function() { var calendarEl =
  document.getElementById('calendar'); 
  var calendar = new FullCalendar.Calendar(calendarEl, { 
    schedulerLicenseKey: 'GPL-My-Project-Is-Open-Source',
    // plugins: [ 'interaction'], 
    eventClick: function (info) {
      console.log(info.event);
    }, 
    timeZone: 'local', 
    initialView: 'timeGridWeek',
    events: formattedData
  });
  calendar.render(); });
</script>
<div id="calendar"></div>
<script src="/js/main.js"></script>